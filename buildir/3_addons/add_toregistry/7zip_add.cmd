reg.exe add "HKLM\PESOFTWARE\Classes\*\shellex\ContextMenuHandlers\7-Zip" /ve /t REG_SZ /d "{23170F69-40C1-278A-1000-000100020000}"
reg.exe add "HKLM\PESOFTWARE\Classes\CLSID\{23170F69-40C1-278A-1000-000100020000}" /ve /t REG_SZ /d "7-Zip Shell Extension"
reg.exe add "HKLM\PESOFTWARE\Classes\CLSID\{23170F69-40C1-278A-1000-000100020000}\InprocServer32" /ve /t REG_SZ /d "X:\Tools\7-zip\7-zip.dll"
reg.exe add "HKLM\PESOFTWARE\Classes\CLSID\{23170F69-40C1-278A-1000-000100020000}\InprocServer32" /v "ThreadingModel" /t REG_SZ /d "Apartment"
reg.exe add "HKLM\PESOFTWARE\Classes\Directory\shellex\ContextMenuHandlers\7-Zip" /ve /t REG_SZ /d "{23170F69-40C1-278A-1000-000100020000}"
reg.exe add "HKLM\PESOFTWARE\Classes\Directory\shellex\DragDropHandlers\7-Zip" /ve /t REG_SZ /d "{23170F69-40C1-278A-1000-000100020000}"
reg.exe add "HKLM\PESOFTWARE\Classes\Drive\shellex\DragDropHandlers\7-Zip" /ve /t REG_SZ /d "{23170F69-40C1-278A-1000-000100020000}"
reg.exe add "HKLM\PESOFTWARE\Classes\*\OpenWithList\7zFM.exe" /ve /t REG_SZ /d "7-zip"
reg.exe add "HKLM\PESOFTWARE\Classes\Applications\7zFM.exe\shell\open\command" /ve /t REG_SZ /d "\"X:\Tools\7-zip\7zFM.exe\" \"%%1\""
reg.exe add "HKLM\PESOFTWARE\7-zip" /v "Path" /t REG_SZ /d "X:\Tools\7-zip"
reg.exe add "HKLM\PESOFTWARE\7-zip" /v "Lang" /t REG_SZ /d "-"
